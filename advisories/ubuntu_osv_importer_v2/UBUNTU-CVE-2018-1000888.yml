advisory_id: UBUNTU-CVE-2018-1000888
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2018-1000888
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-1000888.json
aliases:
  - CVE-2018-1000888
summary: PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915 vulnerability
  in the Archive_Tar class. There are several file operations with `$v_header['filename']` as
  parameter (such as file_exists, is_file, is_dir, etc). When extract is called without a specific
  prefix path, we can trigger unserialization by crafting a tar file with `phar://[path_to_malicious_phar_file]`
  as path. Object injection can be used to trigger destruct in the loaded PHP classes, e.g.
  the Archive_Tar class itself. With Archive_Tar object injection, arbitrary file deletion can
  occur because `@unlink($this->_temp_tarname)` is called. If another class with useful gadget
  is loaded, it may possible to cause remote code execution that can result in files being deleted
  or possibly modified. This vulnerability appears to have been fixed in 1.4.4.
impacted_packages:
  - purl: pkg:deb/ubuntu/php-pear?arch=source&distro=xenial
    affected_versions: vers:deb/1:1.10.1+submodules+notgz-4|1:1.10.1+submodules+notgz-6
    fixed_versions: vers:deb/1:1.10.1+submodules+notgz-6ubuntu0.1
  - purl: pkg:deb/ubuntu/php-pear?arch=source&distro=bionic
    affected_versions: vers:deb/1:1.10.5+submodules+notgz-1|1:1.10.5+submodules+notgz-1ubuntu1
    fixed_versions: vers:deb/1:1.10.5+submodules+notgz-1ubuntu1.18.04.1
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-1000888.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-1000888.json
weaknesses: []
references:
  - url: http://blog.pear.php.net/2018/12/20/security-vulnerability-announcement-archive_tar/
    reference_type:
    reference_id:
  - url: https://blog.ripstech.com/2018/new-php-exploitation-technique/
    reference_type:
    reference_id:
  - url: https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf
    reference_type:
    reference_id:
  - url: https://pear.php.net/package/Archive_Tar/download/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2018-1000888
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3857-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2018-1000888
    reference_type:
    reference_id:
