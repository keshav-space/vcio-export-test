advisory_id: UBUNTU-CVE-2018-20346
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2018-20346
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-20346.json
aliases:
  - CVE-2018-20346
summary: SQLite before 3.25.3, when the FTS3 extension is enabled, encounters an integer overflow
  (and resultant buffer overflow) for FTS3 queries that occur after crafted changes to FTS3
  shadow tables, allowing remote attackers to execute arbitrary code by leveraging the ability
  to run arbitrary SQL statements (such as in certain WebSQL use cases), aka Magellan.
impacted_packages:
  - purl: pkg:deb/ubuntu/sqlite3?arch=source&distro=trusty/esm
    affected_versions: vers:deb/3.7.17-1ubuntu1|3.8.0.2-1ubuntu1|3.8.1-1ubuntu1|3.8.1-1ubuntu3|3.8.2-1ubuntu1|3.8.2-1ubuntu2|3.8.2-1ubuntu2.1|3.8.2-1ubuntu2.2
    fixed_versions: vers:deb/3.8.2-1ubuntu2.2+esm1
  - purl: pkg:deb/ubuntu/sqlite3?arch=source&distro=xenial
    affected_versions: vers:deb/3.8.11.1-1|3.9.1-2|3.9.2-1|3.10.0-1|3.10.1-1|3.10.2-1|3.11.0-1ubuntu1|3.11.0-1ubuntu1.1
    fixed_versions: vers:deb/3.11.0-1ubuntu1.2
  - purl: pkg:deb/ubuntu/sqlite3?arch=source&distro=bionic
    affected_versions: vers:deb/3.19.3-3|3.20.1-2|3.21.0-1|3.22.0-1
    fixed_versions: vers:deb/3.22.0-1ubuntu0.1
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-20346.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-20346.json
weaknesses: []
references:
  - url: https://access.redhat.com/articles/3758321
    reference_type:
    reference_id:
  - url: https://blade.tencent.com/magellan/index_en.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1659379
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1659677
    reference_type:
    reference_id:
  - url: https://chromereleases.googleblog.com/2018/12/stable-channel-update-for-desktop.html
    reference_type:
    reference_id:
  - url: https://chromium.googlesource.com/chromium/src/+/c368e30ae55600a1c3c9cb1710a54f9c55de786e
    reference_type:
    reference_id:
  - url: https://crbug.com/900910
    reference_type:
    reference_id:
  - url: https://github.com/zhuowei/worthdoingbadly.com/blob/master/_posts/2018-12-14-sqlitebug.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2018/12/msg00012.html
    reference_type:
    reference_id:
  - url: https://news.ycombinator.com/item?id=18685296
    reference_type:
    reference_id:
  - url: https://sqlite.org/src/info/940f2adc8541a838
    reference_type:
    reference_id:
  - url: https://sqlite.org/src/info/d44318f59044162e
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2018-20346
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4019-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4019-2
    reference_type:
    reference_id:
  - url: https://worthdoingbadly.com/sqlitebug/
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2018-20346
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/sqlite-users@mailinglists.sqlite.org/msg113218.html
    reference_type:
    reference_id:
  - url: https://www.sqlite.org/releaselog/3_25_3.html
    reference_type:
    reference_id:
