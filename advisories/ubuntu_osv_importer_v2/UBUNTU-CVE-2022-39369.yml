advisory_id: UBUNTU-CVE-2022-39369
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-39369
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39369.json
aliases:
  - CVE-2022-39369
summary: 'phpCAS is an authentication library that allows PHP applications to easily authenticate
  users via a Central Authentication Service (CAS) server. The phpCAS library uses HTTP headers
  to determine the service URL used to validate tickets. This allows an attacker to control
  the host header and use a valid ticket granted for any authorized service in the same SSO
  realm (CAS server) to authenticate to the service protected by phpCAS. Depending on the settings
  of the CAS server service registry in worst case this may be any other service URL (if the
  allowed URLs are configured to "^(https)://.*") or may be strictly limited to known and authorized
  services in the same SSO federation if proper URL service validation is applied. This vulnerability
  may allow an attacker to gain access to a victim''s account on a vulnerable CASified service
  without victim''s knowledge, when the victim visits attacker''s website while being logged
  in to the same CAS server. phpCAS 1.6.0 is a major version upgrade that starts enforcing service
  URL discovery validation, because there is unfortunately no 100% safe default config to use
  in PHP. Starting this version, it is required to pass in an additional service base URL argument
  when constructing the client class. For more information, please refer to the upgrading doc.
  This vulnerability only impacts the CAS client that the phpCAS library protects against. The
  problematic service URL discovery behavior in phpCAS < 1.6.0 will only be disabled, and thus
  you are not impacted from it, if the phpCAS configuration has the following setup: 1. `phpCAS::setUrl()`
  is called (a reminder that you have to pass in the full URL of the current page, rather than
  your service base URL), and 2. `phpCAS::setCallbackURL()` is called, only when the proxy mode
  is enabled. 3. If your PHP''s HTTP header input `X-Forwarded-Host`, `X-Forwarded-Server`,
  `Host`, `X-Forwarded-Proto`, `X-Forwarded-Protocol` is sanitized before reaching PHP (by a
  reverse proxy, for example), you will not be impacted by this vulnerability either. If your
  CAS server service registry is configured to only allow known and trusted service URLs the
  severity of the vulnerability is reduced substantially in its severity since an attacker must
  be in control of another authorized service. Otherwise, you should upgrade the library to
  get the safe service discovery behavior.'
impacted_packages:
  - purl: pkg:deb/ubuntu/moodle?arch=source&distro=xenial
    affected_versions: vers:deb/2.7.9+dfsg-1|2.7.10+dfsg-1|2.7.11+dfsg-1|2.7.11+dfsg-2|2.7.12+dfsg-1|3.0.3+dfsg-0ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ocsinventory-server?arch=source&distro=xenial
    affected_versions: vers:deb/2.1.2-1|2.1.2-1ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-cas?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.3.3-1|1.3.3-2|1.3.3-2ubuntu1
    fixed_versions: vers:deb/1.3.3-2ubuntu1+esm1
  - purl: pkg:deb/ubuntu/moodle?arch=source&distro=bionic
    affected_versions: vers:deb/3.0.3+dfsg-0ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-cas?arch=source&distro=bionic
    affected_versions: vers:deb/1.3.3-4
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-cas?arch=source&distro=focal
    affected_versions: vers:deb/1.3.6-1|1.3.8-1
    fixed_versions: vers:deb/1.3.8-1ubuntu0.20.04.1
  - purl: pkg:deb/ubuntu/ocsinventory-server?arch=source&distro=jammy
    affected_versions: vers:deb/2.8.1+dfsg1-1
    fixed_versions: vers:deb/2.8.1+dfsg1-1ubuntu0.1
  - purl: pkg:deb/ubuntu/php-cas?arch=source&distro=jammy
    affected_versions: vers:deb/1.3.8-1
    fixed_versions: vers:deb/1.3.8-1ubuntu0.22.04.1
severities:
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39369.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39369.json
weaknesses: []
references:
  - url: https://github.com/apereo/phpCAS/security/advisories/GHSA-8q72-6qq8-xv64
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-39369
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6913-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6913-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6914-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-39369
    reference_type:
    reference_id:
