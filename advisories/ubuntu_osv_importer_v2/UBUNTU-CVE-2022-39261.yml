advisory_id: UBUNTU-CVE-2022-39261
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-39261
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39261.json
aliases:
  - CVE-2022-39261
summary: Twig is a template language for PHP. Versions 1.x prior to 1.44.7, 2.x prior to 2.15.3,
  and 3.x prior to 3.4.3 encounter an issue when the filesystem loader loads templates for which
  the name is a user input. It is possible to use the `source` or `include` statement to read
  arbitrary files from outside the templates' directory when using a namespace like `@somewhere/../some.file`.
  In such a case, validation is bypassed. Versions 1.44.7, 2.15.3, and 3.4.3 contain a fix for
  validation of such template names. There are no known workarounds aside from upgrading.
impacted_packages:
  - purl: pkg:deb/ubuntu/twig?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.20.0-1|1.23.1-1ubuntu1|1.23.1-1ubuntu4
    fixed_versions: vers:deb/1.23.1-1ubuntu4+esm1
  - purl: pkg:deb/ubuntu/twig?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.24.0-2ubuntu1|2.4.4-2ubuntu1|2.4.6-1
    fixed_versions: vers:deb/2.4.6-1ubuntu0.1~esm1
  - purl: pkg:deb/ubuntu/php-twig?arch=source&distro=esm-apps/focal
    affected_versions: vers:deb/2.11.3-2|2.12.1-1|2.12.2-1|2.12.3-1|2.12.5-1
    fixed_versions: vers:deb/2.12.5-1ubuntu0.1~esm1
  - purl: pkg:deb/ubuntu/php-twig?arch=source&distro=esm-apps/jammy
    affected_versions: vers:deb/3.3.2-1ubuntu3|3.3.4-1|3.3.6-1|3.3.7-1|3.3.8-2ubuntu4
    fixed_versions: vers:deb/3.3.8-2ubuntu4+esm1
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39261.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-39261.json
weaknesses: []
references:
  - url: https://github.com/twigphp/Twig/commit/35f3035c5deb0041da7b84daf02dea074ddc7a0b
    reference_type:
    reference_id:
  - url: https://github.com/twigphp/Twig/security/advisories/GHSA-52m2-vc4m-jj33
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-39261
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5947-1
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-39261
    reference_type:
    reference_id:
  - url: https://www.drupal.org/sa-core-2022-016
    reference_type:
    reference_id:
