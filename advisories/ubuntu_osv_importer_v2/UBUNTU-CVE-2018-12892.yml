advisory_id: UBUNTU-CVE-2018-12892
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2018-12892
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-12892.json
aliases:
  - CVE-2018-12892
summary: An issue was discovered in Xen 4.7 through 4.10.x. libxl fails to pass the readonly
  flag to qemu when setting up a SCSI disk, due to what was probably an erroneous merge conflict
  resolution. Malicious guest administrators or (in some situations) users may be able to write
  to supposedly read-only disk images. Only emulated SCSI disks (specified as "sd" in the libxl
  disk configuration, or an equivalent) are affected. IDE disks ("hd") are not affected (because
  attempts to make them readonly are rejected). Additionally, CDROM devices (that is, devices
  specified to be presented to the guest as CDROMs, regardless of the nature of the backing
  storage on the host) are not affected; they are always read only. Only systems using qemu-xen
  (rather than qemu-xen-traditional) as the device model version are vulnerable. Only systems
  using libxl or libxl-based toolstacks are vulnerable. (This includes xl, and libvirt with
  the libxl driver.) The vulnerability is present in Xen versions 4.7 and later. (In earlier
  versions, provided that the patch for XSA-142 has been applied, attempts to create read only
  disks are rejected.) If the host and guest together usually support PVHVM, the issue is exploitable
  only if the malicious guest administrator has control of the guest kernel or guest kernel
  command line.
impacted_packages:
  - purl: pkg:deb/ubuntu/xen?arch=source&distro=bionic
    affected_versions: vers:deb/4.9.0-0ubuntu3|4.9.0-0ubuntu4|4.9.2-0ubuntu1
    fixed_versions:
severities:
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-12892.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2018/UBUNTU-CVE-2018-12892.json
weaknesses: []
references:
  - url: https://ubuntu.com/security/CVE-2018-12892
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2018-12892
    reference_type:
    reference_id:
  - url: https://xenbits.xen.org/xsa/advisory-266.html
    reference_type:
    reference_id:
