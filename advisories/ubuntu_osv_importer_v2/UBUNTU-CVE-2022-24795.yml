advisory_id: UBUNTU-CVE-2022-24795
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-24795
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24795.json
aliases:
  - CVE-2022-24795
summary: yajl-ruby is a C binding to the YAJL JSON parsing and generation library. The 1.x branch
  and the 2.x branch of `yajl` contain an integer overflow which leads to subsequent heap memory
  corruption when dealing with large (~2GB) inputs. The reallocation logic at `yajl_buf.c#L64`
  may result in the `need` 32bit integer wrapping to 0 when `need` approaches a value of 0x80000000
  (i.e. ~2GB of data), which results in a reallocation of buf->alloc into a small heap chunk.
  These integers are declared as `size_t` in the 2.x branch of `yajl`, which practically prevents
  the issue from triggering on 64bit platforms, however this does not preclude this issue triggering
  on 32bit builds on which `size_t` is a 32bit integer. Subsequent population of this under-allocated
  heap chunk is based on the original buffer size, leading to heap memory corruption. This vulnerability
  mostly impacts process availability. Maintainers believe exploitation for arbitrary code execution
  is unlikely. A patch is available and anticipated to be part of yajl-ruby version 1.4.2. As
  a workaround, avoid passing large inputs to YAJL.
impacted_packages:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=xenial
    affected_versions: vers:deb/0.9.19-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=xenial
    affected_versions: vers:deb/1.2.0-3build1|1.2.0-3build2|1.2.0-3build3|1.2.0-3build4
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=xenial
    affected_versions: vers:deb/0.7.0-3build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=xenial
    affected_versions: vers:deb/1.1.2-2~ubuntu1|1.1.5-1~build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/yajl?arch=source&distro=trusty/esm
    affected_versions: vers:deb/2.0.4-4
    fixed_versions: vers:deb/2.0.4-4ubuntu0.1~esm1
  - purl: pkg:deb/ubuntu/yajl?arch=source&distro=esm-infra/xenial
    affected_versions: vers:deb/2.1.0-2
    fixed_versions: vers:deb/2.1.0-2ubuntu0.16.04.1~esm1
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=xenial
    affected_versions: vers:deb/1.7.0+repack-4|1.8.2+repack-1|1.8.3+repack-1|1.8.3+repack-2
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=xenial
    affected_versions: vers:deb/1.3.48-4.1|1.3.48-4.1build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/collada2gltf?arch=source&distro=xenial
    affected_versions: vers:deb/20140924-3
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=xenial
    affected_versions: vers:deb/2.3.8-1build1|2.3.11-1|2.4.0-1|2.4.1-1|2.4.1-2|2.4.1-2ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/libbson?arch=source&distro=esm-apps/xenial
    affected_versions: vers:deb/1.3.1-1|1.3.1-1ubuntu0.1~esm1
    fixed_versions:
  - purl: pkg:deb/ubuntu/tulip?arch=source&distro=xenial
    affected_versions: vers:deb/4.7.0dfsg-1ubuntu1|4.7.0dfsg-1ubuntu2|4.7.0dfsg-2ubuntu1|4.7.0dfsg-2ubuntu2|4.8.0dfsg-1|4.8.0dfsg-1build1|4.8.0dfsg-2|4.8.0dfsg-2build1|4.8.0dfsg-2build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/yajl?arch=source&distro=esm-infra/bionic
    affected_versions: vers:deb/2.1.0-2|2.1.0-2build1
    fixed_versions: vers:deb/2.1.0-2ubuntu0.18.04.1~esm1
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=bionic
    affected_versions: vers:deb/1.9.2+repack-1|1.9.2+repack-2|2.0.0+repack-1build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=bionic
    affected_versions: vers:deb/2.0.54-1|2.0.54-4build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/collada2gltf?arch=source&distro=bionic
    affected_versions: vers:deb/20140924-4
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=bionic
    affected_versions: vers:deb/2.7.0-1|2.8.1-0ubuntu2
    fixed_versions:
  - purl: pkg:deb/ubuntu/libbson?arch=source&distro=esm-apps/bionic
    affected_versions: vers:deb/1.8.0-1|1.8.1-1|1.9.0-1|1.9.2-1|1.9.2-1ubuntu0.1~esm2
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=bionic
    affected_versions: vers:deb/0.8.2-3
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=bionic
    affected_versions: vers:deb/1.2.3-1build1|1.3.4-1build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=bionic
    affected_versions: vers:deb/1.2-1build1|1.5-2
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=bionic
    affected_versions: vers:deb/1.2.0-3build4|1.2.0-3.1|1.3.1-1|1.3.1-1build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/yajl?arch=source&distro=focal
    affected_versions: vers:deb/2.1.0-3
    fixed_versions: vers:deb/2.1.0-3ubuntu0.20.04.1
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=focal
    affected_versions: vers:deb/2.0.1+repack-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=focal
    affected_versions: vers:deb/2.2.18-2
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=focal
    affected_versions: vers:deb/2.10.5-1build1|2.11.2-1|2.11.2-1ubuntu1|2.11.2-1ubuntu2|2.11.2-1ubuntu3
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=focal
    affected_versions: vers:deb/0.8.4-5build1|0.8.5-2|0.8.5-2build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=focal
    affected_versions: vers:deb/1.5.5-1build1|1.6.1-4|1.6.1-4build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=focal
    affected_versions: vers:deb/1.6+dfsg-1|1.6.1+dfsg-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=focal
    affected_versions: vers:deb/1.3.1-1build1|1.3.1-1build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=jammy
    affected_versions: vers:deb/2.0.1+repack-2|2.2.0+repack-1|2.2.0+repack-1build1
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=jammy
    affected_versions: vers:deb/2.2.18-8ubuntu2|2.4.0-3ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/collada2gltf?arch=source&distro=jammy
    affected_versions: vers:deb/20140924-7build1|20140924-8
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=jammy
    affected_versions: vers:deb/2.12.3-1|2.13.1-1|2.13.2-1|2.13.2-1build1|2.13.2-1build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=jammy
    affected_versions: vers:deb/0.9.0-1|0.9.0-2ubuntu1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=jammy
    affected_versions: vers:deb/1.9.0+1.7.5-2build2|1.11.1+1.9.2+1.7.5-4|1.12.0+1.9.2+1.7.5-3|1.12.0+1.9.2+1.7.5-4
    fixed_versions:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=jammy
    affected_versions: vers:deb/1.7.2+dfsg-1|1.7.3+dfsg-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=jammy
    affected_versions: vers:deb/1.4.1-1|1.4.1-1build1|1.4.1-1build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/tulip?arch=source&distro=jammy
    affected_versions: vers:deb/5.4.0+dfsg-3|5.4.0+dfsg-3build1|5.4.0+dfsg-3build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/yajl?arch=source&distro=jammy
    affected_versions: vers:deb/2.1.0-3|2.1.0-3build1|2.1.0-3build2
    fixed_versions: vers:deb/2.1.0-3ubuntu0.22.04.1
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=noble
    affected_versions: vers:deb/2.3.1+repack-1ubuntu2|3.1.0+repack-1|3.1.0+repack-1build2|3.1.0+repack-1build3|3.1.0+repack-1build4
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=noble
    affected_versions: vers:deb/3.1.4-1|3.1.4-3|3.1.4-3ubuntu1|3.1.4-3.1|3.1.4-3.1build1|3.1.4-3.1build2|3.1.4-3.1build3
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=noble
    affected_versions: vers:deb/2.13.8-1|2.14.1-1|2.14.2-1|2.14.2-1build1|2.14.2-1build2
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=noble
    affected_versions: vers:deb/0.11.2-1|0.11.2-1build2|0.11.2-1build3
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=noble
    affected_versions: vers:deb/1.15.0+1.11.1+1.9.2+1.7.5-1build1|1.15.0+1.11.1+1.9.2+1.7.5-1ubuntu1|1.15.0+1.11.1+1.9.2+1.7.5-1ubuntu2|1.15.0+1.11.1+1.9.2+1.7.5-1ubuntu3
    fixed_versions:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=noble
    affected_versions: vers:deb/1.8.5+dfsg-1|1.8.7+dfsg-1|1.8.8+dfsg-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=noble
    affected_versions: vers:deb/1.4.3-1build2|1.4.3-1build3|1.4.3-1build4
    fixed_versions:
  - purl: pkg:deb/ubuntu/argyll?arch=source&distro=questing
    affected_versions: vers:deb/3.1.0+repack-1.1|3.3.0+repack-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/burp?arch=source&distro=questing
    affected_versions: vers:deb/3.1.4-4
    fixed_versions:
  - purl: pkg:deb/ubuntu/icinga2?arch=source&distro=questing
    affected_versions: vers:deb/2.14.5-1|2.14.6-1|2.15.0-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/lnav?arch=source&distro=questing
    affected_versions: vers:deb/0.12.3-2|0.12.4-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/php-mongodb?arch=source&distro=questing
    affected_versions: vers:deb/1.21.0-1|2.0.0-1|2.1.0-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/r-cran-jsonlite?arch=source&distro=questing
    affected_versions: vers:deb/1.9.1+dfsg-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/ruby-yajl?arch=source&distro=questing
    affected_versions: vers:deb/1.4.3-1build5
    fixed_versions:
  - purl: pkg:deb/ubuntu/tulip?arch=source&distro=questing
    affected_versions: vers:deb/6.0.1+dfsg-2
    fixed_versions:
severities:
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24795.json
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24795.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-24795.json
weaknesses: []
references:
  - url: https://github.com/brianmario/yajl-ruby/pull/211
    reference_type:
    reference_id:
  - url: https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-24795
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6233-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-6233-2
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-24795
    reference_type:
    reference_id:
