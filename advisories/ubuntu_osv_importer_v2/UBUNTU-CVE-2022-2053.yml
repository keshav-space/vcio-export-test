advisory_id: UBUNTU-CVE-2022-2053
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-2053
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-2053.json
aliases:
  - CVE-2022-2053
summary: When a POST request comes through AJP and the request exceeds the max-post-size limit
  (maxEntitySize), Undertow's AjpServerRequestConduit implementation closes a connection without
  sending any response to the client/proxy. This behavior results in that a front-end proxy
  marking the backend worker (application server) as an error state and not forward requests
  to the worker for a while. In mod_cluster, this continues until the next STATUS request (10
  seconds intervals) from the application server updates the server state. So, in the worst
  case, it can result in "All workers are in error state" and mod_cluster responds "503 Service
  Unavailable" for a while (up to 10 seconds). In mod_proxy_balancer, it does not forward requests
  to the worker until the "retry" timeout passes. However, luckily, mod_proxy_balancer has "forcerecovery"
  setting (On by default; this parameter can force the immediate recovery of all workers without
  considering the retry parameter of the workers if all workers of a balancer are in error state.).
  So, unlike mod_cluster, mod_proxy_balancer does not result in responding "503 Service Unavailable".
  An attacker could use this behavior to send a malicious request and trigger server errors,
  resulting in DoS (denial of service). This flaw was fixed in Undertow 2.2.19.Final, Undertow
  2.3.0.Alpha2.
impacted_packages:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=jammy
    affected_versions: vers:deb/2.2.8-1|2.2.12-1|2.2.13-1|2.2.14-1|2.2.16-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=noble
    affected_versions: vers:deb/2.3.8-2
    fixed_versions:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=questing
    affected_versions: vers:deb/2.3.18-1|2.3.18-2
    fixed_versions:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=xenial
    affected_versions: vers:deb/1.3.4-1|1.3.5-1|1.3.7-1|1.3.11-1|1.3.16-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=bionic
    affected_versions: vers:deb/1.4.20-1|1.4.21-1|1.4.22-1|1.4.23-1|1.4.23-2build1|1.4.23-3
    fixed_versions:
  - purl: pkg:deb/ubuntu/undertow?arch=source&distro=focal
    affected_versions: vers:deb/2.0.23-1|2.0.27-1|2.0.28-1|2.0.29-1
    fixed_versions:
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-2053.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-2053.json
weaknesses: []
references:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2095862
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-2053
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-2053
    reference_type:
    reference_id:
