advisory_id: UBUNTU-CVE-2022-36083
datasource_id: ubuntu_osv_importer_v2/UBUNTU-CVE-2022-36083
datasource_url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-36083.json
aliases:
  - CVE-2022-36083
summary: 'JOSE is "JSON Web Almost Everything" - JWA, JWS, JWE, JWT, JWK, JWKS with no dependencies
  using runtime''s native crypto in Node.js, Browser, Cloudflare Workers, Electron, and Deno.
  The PBKDF2-based JWE key management algorithms expect a JOSE Header Parameter named `p2c`
  PBES2 Count, which determines how many PBKDF2 iterations must be executed in order to derive
  a CEK wrapping key. The purpose of this parameter is to intentionally slow down the key derivation
  function in order to make password brute-force and dictionary attacks more expensive. This
  makes the PBES2 algorithms unsuitable for situations where the JWE is coming from an untrusted
  source: an adversary can intentionally pick an extremely high PBES2 Count value, that will
  initiate a CPU-bound computation that may take an unreasonable amount of time to finish. Under
  certain conditions, it is possible to have the user''s environment consume unreasonable amount
  of CPU time. The impact is limited only to users utilizing the JWE decryption APIs with symmetric
  secrets to decrypt JWEs from untrusted parties who do not limit the accepted JWE Key Management
  Algorithms (`alg` Header Parameter) using the `keyManagementAlgorithms` (or `algorithms` in
  v1.x) decryption option or through other means. The `v1.28.2`, `v2.0.6`, `v3.20.4`, and `v4.9.2`
  releases limit the maximum PBKDF2 iteration count to `10000` by default. It is possible to
  adjust this limit with a newly introduced `maxPBES2Count` decryption option. If users are
  unable to upgrade their required library version, they have two options depending on whether
  they expect to receive JWEs using any of the three PBKDF2-based JWE key management algorithms.
  They can use the `keyManagementAlgorithms` decryption option to disable accepting PBKDF2 altogether,
  or they can inspect the JOSE Header prior to using the decryption API and limit the PBKDF2
  iteration count (`p2c` Header Parameter).'
impacted_packages:
  - purl: pkg:deb/ubuntu/node-jose?arch=source&distro=jammy
    affected_versions: vers:deb/4.3.7+ds-1|4.4.0+ds-1|4.5.0+ds-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/jose?arch=source&distro=noble
    affected_versions: vers:deb/11-2|11-3|11-3build1|11-3build2|13-1
    fixed_versions:
  - purl: pkg:deb/ubuntu/jose?arch=source&distro=questing
    affected_versions: vers:deb/14-1|14-2|14-2build1
    fixed_versions:
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-36083.json
  - score: medium
    scoring_system: ubuntu-priority
    scoring_elements:
    published_at: None
    url: https://github.com/canonical/ubuntu-security-notices/blob/main/osv/cve/2022/UBUNTU-CVE-2022-36083.json
weaknesses: []
references:
  - url: https://github.com/panva/jose/commit/03d6d013bf6e070e85adfe5731f526978e3e8e4d
    reference_type:
    reference_id:
  - url: https://github.com/panva/jose/security/advisories/GHSA-jv3g-j58f-9mq9
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/CVE-2022-36083
    reference_type:
    reference_id:
  - url: https://www.cve.org/CVERecord?id=CVE-2022-36083
    reference_type:
    reference_id:
