advisory_id: CVE-2024-4741
datasource_id: openssl_importer_v2/CVE-2024-4741
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2024-4741.json
aliases: []
summary: |
  Use After Free with SSL_free_buffers
  Issue summary: Calling the OpenSSL API function SSL_free_buffers may cause
  memory to be accessed that was previously freed in some situations

  Impact summary: A use after free can have a range of potential consequences such
  as the corruption of valid data, crashes or execution of arbitrary code.
  However, only applications that directly call the SSL_free_buffers function are
  affected by this issue. Applications that do not call this function are not
  vulnerable. Our investigations indicate that this function is rarely used by
  applications.

  The SSL_free_buffers function is used to free the internal OpenSSL buffer used
  when processing an incoming record from the network. The call is only expected
  to succeed if the buffer is not currently in use. However, two scenarios have
  been identified where the buffer is freed even when still in use.

  The first scenario occurs where a record header has been received from the
  network and processed by OpenSSL, but the full record body has not yet arrived.
  In this case calling SSL_free_buffers will succeed even though a record has only
  been partially processed and the buffer is still in use.

  The second scenario occurs where a full record containing application data has
  been received and processed by OpenSSL but the application has only read part of
  this data. Again a call to SSL_free_buffers will succeed even though the buffer
  is still in use.

  While these scenarios could occur accidentally during normal operation a
  malicious attacker could attempt to engineer a stituation where this occurs.
  We are not aware of this issue being actively exploited.

  The FIPS modules in 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.3.0|<3.3.1
    fixed_versions: vers:openssl/3.3.1
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.2.0|<3.2.2
    fixed_versions: vers:openssl/3.2.2
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.1.0|<3.1.6
    fixed_versions: vers:openssl/3.1.6
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.0.0|<3.0.14
    fixed_versions: vers:openssl/3.0.14
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.1.1|<1.1.1y
    fixed_versions: vers:openssl/1.1.1y
severities:
  - score: Low
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2024-4741.json
weaknesses:
  - CWE-416
references:
  - url: https://github.openssl.org/openssl/extended-releases/commit/f7a045f3143fc6da2ee66bf52d8df04829590dd4
    reference_type: commit
    reference_id: 1.1.1y git commit
  - url: https://github.com/openssl/openssl/commit/b3f0eb0a295f58f16ba43ba99dad70d4ee5c437d
    reference_type: commit
    reference_id: 3.0.14 git commit
  - url: https://github.com/openssl/openssl/commit/704f725b96aa373ee45ecfb23f6abfe8be8d9177
    reference_type: commit
    reference_id: 3.1.6 git commit
  - url: https://github.com/openssl/openssl/commit/c88c3de51020c37e8706bf7a682a162593053aac
    reference_type: commit
    reference_id: 3.2.2 git commit
  - url: https://github.com/openssl/openssl/commit/e5093133c35ca82874ad83697af76f4b0f7e3bd8
    reference_type: commit
    reference_id: 3.3.1 git commit
  - url: https://www.openssl.org/news/secadv/20240528.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
