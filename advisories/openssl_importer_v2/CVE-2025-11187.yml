advisory_id: CVE-2025-11187
datasource_id: openssl_importer_v2/CVE-2025-11187
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2025-11187.json
aliases: []
summary: |
  Improper validation of PBMAC1 parameters in PKCS#12 MAC verification
  Issue summary: PBMAC1 parameters in PKCS#12 files are missing validation
  which can trigger a stack-based buffer overflow, invalid pointer or NULL
  pointer dereference during MAC verification.

  Impact summary: The stack buffer overflow or NULL pointer dereference may
  cause a crash leading to Denial of Service for an application that parses
  untrusted PKCS#12 files. The buffer overflow may also potentially enable
  code execution depending on platform mitigations.

  When verifying a PKCS#12 file that uses PBMAC1 for the MAC, the PBKDF2
  salt and keylength parameters from the file are used without validation.
  If the value of keylength exceeds the size of the fixed stack buffer used
  for the derived key (64 bytes), the key derivation will overflow the buffer.
  The overflow length is attacker-controlled. Also, if the salt parameter is
  not an OCTET STRING type this can lead to invalid or NULL pointer
  dereference.

  Exploiting this issue requires a user or application to process
  a maliciously crafted PKCS#12 file. It is uncommon to accept untrusted
  PKCS#12 files in applications as they are usually used to store private
  keys which are trusted by definition. For this reason the issue was assessed
  as Moderate severity.

  The FIPS modules in 3.6, 3.5 and 3.4 are not affected by this issue, as
  PKCS#12 processing is outside the OpenSSL FIPS module boundary.

  OpenSSL 3.6, 3.5 and 3.4 are vulnerable to this issue.

  OpenSSL 3.3, 3.0, 1.1.1 and 1.0.2 are not affected by this issue as they do
  not support PBMAC1 in PKCS#12.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.6.0|<3.6.1
    fixed_versions: vers:openssl/3.6.1
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.5.0|<3.5.5
    fixed_versions: vers:openssl/3.5.5
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.4.0|<3.4.4
    fixed_versions: vers:openssl/3.4.4
severities:
  - score: Moderate
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2025-11187.json
weaknesses:
  - CWE-787
references:
  - url: https://github.com/openssl/openssl/commit/205e3a55e16e4bd08c12fdbd3416ab829c0f6206
    reference_type: commit
    reference_id: 3.4.4 git commit
  - url: https://github.com/openssl/openssl/commit/e1079bc17ed93ff16f6b86f33a2fe3336e78817e
    reference_type: commit
    reference_id: 3.5.5 git commit
  - url: https://github.com/openssl/openssl/commit/8caf359d6e46fb413e8f5f0df765d2e8a51df4e8
    reference_type: commit
    reference_id: 3.6.1 git commit
  - url: https://openssl-library.org/news/secadv/20260127.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
