advisory_id: CVE-2023-2650
datasource_id: openssl_importer_v2/CVE-2023-2650
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2023-2650.json
aliases: []
summary: |
  Possible DoS translating ASN.1 object identifiers
  Issue summary: Processing some specially crafted ASN.1 object identifiers or
  data containing them may be very slow.

  Impact summary: Applications that use OBJ_obj2txt() directly, or use any of
  the OpenSSL subsystems OCSP, PKCS7/SMIME, CMS, CMP/CRMF or TS with no message
  size limit may experience notable to very long delays when processing those
  messages, which may lead to a Denial of Service.

  An OBJECT IDENTIFIER is composed of a series of numbers - sub-identifiers -
  most of which have no size limit.  OBJ_obj2txt() may be used to translate
  an ASN.1 OBJECT IDENTIFIER given in DER encoding form (using the OpenSSL
  type ASN1_OBJECT) to its canonical numeric text form, which are the
  sub-identifiers of the OBJECT IDENTIFIER in decimal form, separated by
  periods.

  When one of the sub-identifiers in the OBJECT IDENTIFIER is very large
  (these are sizes that are seen as absurdly large, taking up tens or hundreds
  of KiBs), the translation to a decimal number in text may take a very long
  time.  The time complexity is O(n^2) with 'n' being the size of the
  sub-identifiers in bytes (*).

  With OpenSSL 3.0, support to fetch cryptographic algorithms using names /
  identifiers in string form was introduced.  This includes using OBJECT
  IDENTIFIERs in canonical numeric text form as identifiers for fetching
  algorithms.

  Such OBJECT IDENTIFIERs may be received through the ASN.1 structure
  AlgorithmIdentifier, which is commonly used in multiple protocols to specify
  what cryptographic algorithm should be used to sign or verify, encrypt or
  decrypt, or digest passed data.

  Applications that call OBJ_obj2txt() directly with untrusted data are
  affected, with any version of OpenSSL.  If the use is for the mere purpose
  of display, the severity is considered low.

  In OpenSSL 3.0 and newer, this affects the subsystems OCSP, PKCS7/SMIME,
  CMS, CMP/CRMF or TS.  It also impacts anything that processes X.509
  certificates, including simple things like verifying its signature.

  The impact on TLS is relatively low, because all versions of OpenSSL have a
  100KiB limit on the peer's certificate chain.  Additionally, this only
  impacts clients, or servers that have explicitly enabled client
  authentication.

  In OpenSSL 1.1.1 and 1.0.2, this only affects displaying diverse objects,
  such as X.509 certificates.  This is assumed to not happen in such a way
  that it would cause a Denial of Service, so these versions are considered
  not affected by this issue in such a way that it would be cause for concern,
  and the severity is therefore considered low.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/<3.1.1|>=3.1.1
    fixed_versions: vers:openssl/3.1.1
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.0.0|<3.0.9
    fixed_versions: vers:openssl/3.0.9
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.1.1|<1.1.1u
    fixed_versions: vers:openssl/1.1.1u
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.0.2|<1.0.2zh
    fixed_versions: vers:openssl/1.0.2zh
severities:
  - score: Moderate
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2023-2650.json
weaknesses: []
references:
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=853c5e56ee0b8650c73140816bb8b91d6163422c
    reference_type: commit
    reference_id: 1.0.2zh patch (premium)
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=9e209944b35cf82368071f160a744b6178f9b098
    reference_type: commit
    reference_id: 1.1.1u git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=423a2bc737a908ad0c77bda470b2b59dc879936b
    reference_type: commit
    reference_id: 3.0.9 git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=db779b0e10b047f2585615e0b8f2acdf21f8544a
    reference_type: commit
    reference_id: 3.1.1 git commit
  - url: https://www.openssl.org/news/secadv/20230530.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
