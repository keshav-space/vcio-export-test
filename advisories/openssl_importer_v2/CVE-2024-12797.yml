advisory_id: CVE-2024-12797
datasource_id: openssl_importer_v2/CVE-2024-12797
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2024-12797.json
aliases: []
summary: |
  RFC7250 handshakes with unauthenticated servers don't abort as expected
  Issue summary: Clients using RFC7250 Raw Public Keys (RPKs) to authenticate a
  server may fail to notice that the server was not authenticated, because
  handshakes don't abort as expected when the SSL_VERIFY_PEER verification mode
  is set.

  Impact summary: TLS and DTLS connections using raw public keys may be
  vulnerable to man-in-middle attacks when server authentication failure is not
  detected by clients.

  RPKs are disabled by default in both TLS clients and TLS servers.  The issue
  only arises when TLS clients explicitly enable RPK use by the server, and the
  server, likewise, enables sending of an RPK instead of an X.509 certificate
  chain.  The affected clients are those that then rely on the handshake to
  fail when the server's RPK fails to match one of the expected public keys,
  by setting the verification mode to SSL_VERIFY_PEER.

  Clients that enable server-side raw public keys can still find out that raw
  public key verification failed by calling SSL_get_verify_result(), and those
  that do, and take appropriate action, are not affected.  This issue was
  introduced in the initial implementation of RPK support in OpenSSL 3.2.

  The FIPS modules in 3.4, 3.3, 3.2, 3.1 and 3.0 are not affected by this issue.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.4.0|<3.4.1
    fixed_versions: vers:openssl/3.4.1
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.3.0|<3.3.3
    fixed_versions: vers:openssl/3.3.3
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.2.0|<3.2.4
    fixed_versions: vers:openssl/3.2.4
severities:
  - score: High
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2024-12797.json
weaknesses:
  - CWE-392
references:
  - url: https://github.com/openssl/openssl/commit/798779d43494549b611233f92652f0da5328fbe7
    reference_type: commit
    reference_id: 3.2.4 git commit
  - url: https://github.com/openssl/openssl/commit/87ebd203feffcf92ad5889df92f90bb0ee10a699
    reference_type: commit
    reference_id: 3.3.3 git commit
  - url: https://github.com/openssl/openssl/commit/738d4f9fdeaad57660dcba50a619fafced3fd5e9
    reference_type: commit
    reference_id: 3.4.1 git commit
  - url: https://openssl-library.org/news/secadv/20250211.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
