advisory_id: CVE-2022-2068
datasource_id: openssl_importer_v2/CVE-2022-2068
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2022-2068.json
aliases: []
summary: |
  The c_rehash script allows command injection
  In addition to the c_rehash shell command injection identified in CVE-2022-1292, further circumstances where the c_rehash script does not properly sanitise shell metacharacters to prevent command injection were found by code review. When the CVE-2022-1292 was fixed it was not discovered that there are other places in the script where the file names of certificates being hashed were possibly passed to a command executed through the shell. This script is distributed by some operating systems in a manner where it is automatically executed. On such operating systems, an attacker could execute arbitrary commands with the privileges of the script. Use of the c_rehash script is considered obsolete and should be replaced by the OpenSSL rehash command line tool.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.0.0|<3.0.4
    fixed_versions: vers:openssl/3.0.4
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.1.1|<1.1.1p
    fixed_versions: vers:openssl/1.1.1p
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.0.2|<1.0.2zf
    fixed_versions: vers:openssl/1.0.2zf
severities:
  - score: Moderate
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2022-2068.json
weaknesses: []
references:
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=7a9c027159fe9e1bbc2cd38a8a2914bff0d5abd9
    reference_type: commit
    reference_id: 1.0.2zf git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=9639817dac8bbbaa64d09efad7464ccc405527c7
    reference_type: commit
    reference_id: 1.1.1p git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=2c9c35870601b4a44d86ddbf512b38df38285cfa
    reference_type: commit
    reference_id: 3.0.4 git commit
  - url: https://www.openssl.org/news/secadv/20220621.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
