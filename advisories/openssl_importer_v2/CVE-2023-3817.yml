advisory_id: CVE-2023-3817
datasource_id: openssl_importer_v2/CVE-2023-3817
datasource_url: https://github.com/openssl/release-metadata/blob/main/secjson/CVE-2023-3817.json
aliases: []
summary: |
  Excessive time spent checking DH q parameter value
  Issue summary: Checking excessively long DH keys or parameters may be very slow.

  Impact summary: Applications that use the functions DH_check(), DH_check_ex()
  or EVP_PKEY_param_check() to check a DH key or DH parameters may experience long
  delays. Where the key or parameters that are being checked have been obtained
  from an untrusted source this may lead to a Denial of Service.

  The function DH_check() performs various checks on DH parameters. After fixing
  CVE-2023-3446 it was discovered that a large q parameter value can also trigger
  an overly long computation during some of these checks. A correct q value,
  if present, cannot be larger than the modulus p parameter, thus it is
  unnecessary to perform these checks if q is larger than p.

  An application that calls DH_check() and supplies a key or parameters obtained
  from an untrusted source could be vulnerable to a Denial of Service attack.

  The function DH_check() is itself called by a number of other OpenSSL functions.
  An application calling any of those other functions may similarly be affected.
  The other functions affected by this are DH_check_ex() and
  EVP_PKEY_param_check().

  Also vulnerable are the OpenSSL dhparam and pkeyparam command line applications
  when using the "-check" option.

  The OpenSSL SSL/TLS implementation is not affected by this issue.

  The OpenSSL 3.0 and 3.1 FIPS providers are not affected by this issue.
impacted_packages:
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.1.0|<3.1.2
    fixed_versions: vers:openssl/3.1.2
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=3.0.0|<3.0.10
    fixed_versions: vers:openssl/3.0.10
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.1.1|<1.1.1v
    fixed_versions: vers:openssl/1.1.1v
  - purl: pkg:openssl/openssl
    affected_versions: vers:openssl/>=1.0.2|<1.0.2zi
    fixed_versions: vers:openssl/1.0.2zi
severities:
  - score: Low
    scoring_system: openssl
    scoring_elements:
    published_at: None
    url: https://openssl-library.org/news/secjson/cve-2023-3817.json
weaknesses: []
references:
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=869ad69aadd985c7b8ca6f4e5dd0eb274c9f3644
    reference_type: commit
    reference_id: 1.0.2zi patch (premium)
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=91ddeba0f2269b017dc06c46c993a788974b1aa5
    reference_type: commit
    reference_id: 1.1.1v git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=9002fd07327a91f35ba6c1307e71fa6fd4409b7f
    reference_type: commit
    reference_id: 3.0.10 git commit
  - url: https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=6a1eb62c29db6cb5eec707f9338aee00f44e26f5
    reference_type: commit
    reference_id: 3.1.2 git commit
  - url: https://www.openssl.org/news/secadv/20230731.txt
    reference_type: advisory
    reference_id: OpenSSL Advisory
